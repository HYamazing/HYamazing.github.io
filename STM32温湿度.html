<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STM32 æ¸©æ¹¿åº¦ï½œå¹»å±¿é€ æ¢¦ç§‘æŠ€å®éªŒå®¤</title>

  <style>
    :root{
      --bg1:#0ea5e9; --bg2:#8b5cf6;
      --card:#ffffff; --text:#0f172a; --muted:#475569; --line:#e2e8f0;
      --shadow: 0 20px 50px rgba(2, 6, 23, .15);
      --radius:18px;
      --ok:#16a34a; --bad:#ef4444;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(255,255,255,.35), transparent 60%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    a{color:inherit; text-decoration:none;}
    .wrap{max-width: 980px; margin:0 auto; padding:18px 18px 60px;}

    .topbar{
      position: sticky; top: 12px; z-index: 50;
      display:flex; justify-content:space-between; align-items:center; gap:12px;
      padding: 10px 12px; border-radius: 16px;
      background: rgba(255,255,255,.18);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,.22);
      box-shadow: 0 10px 25px rgba(0,0,0,.08);
      color: rgba(255,255,255,.95);
      margin-bottom: 14px;
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:700;}
    .brand-badge{width:34px; height:34px; border-radius:10px; background: rgba(255,255,255,.20); display:grid; place-items:center;}
    .nav{display:flex; gap:10px; flex-wrap:wrap; font-size:14px;}
    .nav a{padding:8px 10px; border-radius:999px; background: rgba(255,255,255,.16);}
    .nav a:hover{background: rgba(255,255,255,.24);}

    .card{background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow); overflow:hidden;}
    .header{
      padding:22px 22px 16px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(14,165,233,.10), transparent);
    }
    .header h1{margin:0 0 6px; font-size:26px;}
    .header p{margin:0; color:var(--muted); line-height:1.8;}

    .content{padding:18px;}
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 820px){ .grid{grid-template-columns:1fr;} }

    .panel{
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 16px;
      background:#fff;
    }
    .panel h2{margin:0 0 10px; font-size:18px;}

    /* å¤§æ•°å­—æ˜¾ç¤ºåŒº */
    .big{
      display:flex;
      align-items:flex-end;
      gap:10px;
    }
    .value{
      font-size: 52px;
      font-weight: 800;
      line-height: 1;
    }
    .unit{
      font-size: 16px;
      color: var(--muted);
      padding-bottom: 8px;
    }

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-top: 12px;
      color: var(--muted);
      font-size: 14px;
    }

    /* çŠ¶æ€ç¯ */
    .dot{
      width:10px; height:10px; border-radius:999px; display:inline-block;
      background: var(--bad);
      box-shadow: 0 0 0 4px rgba(239,68,68,.12);
      margin-right: 8px;
    }
    .dot.ok{
      background: var(--ok);
      box-shadow: 0 0 0 4px rgba(22,163,74,.12);
    }

    .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px;}
    .btn{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px; border-radius:12px;
      border:1px solid #e2e8f0; background:#fff; font-size:14px;
      cursor:pointer;
    }
    .btn:hover{background:#f8fafc;}
    .btn.primary{background:#0f172a; color:#fff; border-color:#0f172a;}
    .btn.primary:hover{background:#111c33;}

    .code{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      color: #0f172a;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      padding: 10px;
      border-radius: 12px;
      overflow:auto;
    }

    .footer{text-align:center; color: rgba(255,255,255,.88); font-size:13px; margin-top:16px; opacity:.95;}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="brand-badge">ğŸŒ¡ï¸</div>
        <div>STM32 æ¸©æ¹¿åº¦</div>
      </div>
      <div class="nav">
        <a href="index.html">è¿”å›ä¸»é¡µ</a>
        <a href="#data">æ•°æ®</a>
        <a href="#api">æ¥å£</a>
      </div>
    </div>

    <div class="card">
      <div class="header">
        <h1>æ¸©æ¹¿åº¦å®æ—¶å±•ç¤ºï¼ˆç½‘é¡µç«¯å…ˆæ­å¥½ï¼‰</h1>
        <p>
          ç›®æ ‡ï¼šSTM32F103C8T6 + DHT11 é‡‡é›† â†’ ESP8266 å‘é€åˆ°æ¥å£ â†’ æœ¬é¡µé¢å®šæ—¶æ‹‰å–æœ€æ–°æ•°æ®å¹¶æ˜¾ç¤ºã€‚
          ç›®å‰å…ˆç”¨â€œæ¨¡æ‹Ÿæ•°æ®â€è·‘é€šé¡µé¢ç»“æ„ï¼Œåç»­å†æ¥å…¥çœŸå®æ¥å£ã€‚
        </p>
      </div>

      <div class="content">
        <div class="grid" id="data">
          <div class="panel">
            <h2>æ¸©åº¦</h2>
            <div class="big">
              <div class="value" id="temp">--</div>
              <div class="unit">Â°C</div>
            </div>
            <div class="row">
              <div>çŠ¶æ€ï¼š<span class="dot" id="dot"></span><span id="statusText">ç¦»çº¿/æš‚æ— æ•°æ®</span></div>
              <div>æ›´æ–°æ—¶é—´ï¼š<span id="updatedAt">--</span></div>
            </div>
          </div>

          <div class="panel">
            <h2>æ¹¿åº¦</h2>
            <div class="big">
              <div class="value" id="hum">--</div>
              <div class="unit">%RH</div>
            </div>

            <div class="btns">
              <!-- ç°åœ¨å…ˆç”¨æ¨¡æ‹Ÿï¼šç‚¹å‡»å°±éšæœºåˆ·æ–°ä¸€ç»„æ•°æ® -->
              <button class="btn primary" id="btnMock">æ¨¡æ‹Ÿåˆ·æ–°æ•°æ®</button>
              <!-- æœªæ¥æ¥å…¥æ¥å£åç”¨ï¼šå®šæ—¶/æ‰‹åŠ¨åˆ·æ–° -->
              <button class="btn" id="btnRefresh">ï¼ˆé¢„ç•™ï¼‰ä»æ¥å£åˆ·æ–°</button>
            </div>

            <div class="row">
              <div>è¯´æ˜ï¼šåç»­æ¥å…¥ API åï¼Œâ€œæ¨¡æ‹ŸæŒ‰é’®â€å¯ä»¥åˆ æ‰ã€‚</div>
            </div>
          </div>
        </div>

        <div class="panel" id="api" style="margin-top:12px;">
          <h2>æ¥å£é¢„ç•™ï¼ˆæœªæ¥æ¥å…¥ç¡¬ä»¶æ—¶è¦ç”¨ï¼‰</h2>
          <p style="color:var(--muted); line-height:1.8; margin:0 0 10px;">
            GitHub Pages æ˜¯é™æ€ç«™ï¼Œä¸èƒ½ç›´æ¥æ¥æ”¶ STM32 ä¸Šä¼ çš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªâ€œä¸­é—´ APIâ€ï¼ˆæ¯”å¦‚ Cloudflare Workersï¼‰ã€‚
            åç»­ä½ åªè¦æŠŠä¸‹é¢çš„ API åœ°å€æ¢æˆçœŸå®åœ°å€ï¼Œå¹¶å®ç°ä¸¤ä¸ªæ¥å£å³å¯ã€‚
          </p>

          <div class="code">
/* è®¾å¤‡ä¸Šä¼ ï¼ˆSTM32/ESP8266 è°ƒç”¨ï¼‰ï¼š
   GET  /api/upload?temp=25&hum=60&key=xxx
   æˆ–  POST /api/upload  { temp:25, hum:60, key:"xxx" }

   ç½‘é¡µè¯»å–æœ€æ–°æ•°æ®ï¼ˆæœ¬é¡µé¢è°ƒç”¨ï¼‰ï¼š
   GET /api/latest  ->  { temp: 25, hum: 60, updatedAt: "2025-12-23 16:20:00" }
*/
          </div>
        </div>
      </div>
    </div>

    <div class="footer">Â© <span id="y">2025</span> å¹»å±¿é€ æ¢¦ç§‘æŠ€å®éªŒå®¤ Â· STM32 å·¥ç¨‹é¡µ</div>
  </div>

  <script>
    /* =========================
       æœ¬é¡µ JS è¯´æ˜
       - ç°åœ¨ï¼šç”¨â€œæ¨¡æ‹Ÿåˆ·æ–°â€éšæœºç”Ÿæˆæ¸©æ¹¿åº¦ï¼ŒéªŒè¯é¡µé¢æ˜¾ç¤ºé€»è¾‘
       - æœªæ¥ï¼šæŠŠ fetchLatest() æ¥åˆ°çœŸå® APIï¼ˆCloudflare Worker ç­‰ï¼‰
       ========================= */

    function pad(n){ return n < 10 ? "0"+n : ""+n; }
    function fmt(d){
      return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
    }

    const elTemp = document.getElementById("temp");
    const elHum = document.getElementById("hum");
    const elUpdatedAt = document.getElementById("updatedAt");
    const elDot = document.getElementById("dot");
    const elStatus = document.getElementById("statusText");

    function setOnline(online){
      if(online){
        elDot.classList.add("ok");
        elStatus.textContent = "åœ¨çº¿ï¼ˆæ¨¡æ‹Ÿï¼‰";
      }else{
        elDot.classList.remove("ok");
        elStatus.textContent = "ç¦»çº¿/æš‚æ— æ•°æ®";
      }
    }

    // æ¨¡æ‹Ÿç”Ÿæˆæ•°æ®ï¼ˆå…ˆè·‘é€šé¡µé¢ï¼‰
    function mockData(){
      const temp = (20 + Math.random() * 10).toFixed(1); // 20~30â„ƒ
      const hum  = (40 + Math.random() * 30).toFixed(1); // 40~70%
      elTemp.textContent = temp;
      elHum.textContent = hum;
      elUpdatedAt.textContent = fmt(new Date());
      setOnline(true);
    }

    // æœªæ¥æ¥å…¥çœŸå®æ¥å£ï¼šè¿™é‡Œç”¨ fetch è°ƒç”¨ /api/latest
    async function fetchLatest(){
      // TODOï¼šæœªæ¥æŠŠ API_URL æ¢æˆä½ çš„çœŸå®æ¥å£
      // const API_URL = "https://xxxxxx.workers.dev/api/latest";
      // const res = await fetch(API_URL);
      // const data = await res.json();
      // elTemp.textContent = data.temp;
      // elHum.textContent = data.hum;
      // elUpdatedAt.textContent = data.updatedAt;
      // setOnline(true);

      alert("æ¥å£è¿˜æ²¡æ¥å…¥ï¼šå½“å‰åªæ”¯æŒâ€œæ¨¡æ‹Ÿåˆ·æ–°æ•°æ®â€ã€‚");
    }

    document.getElementById("btnMock").addEventListener("click", mockData);
    document.getElementById("btnRefresh").addEventListener("click", fetchLatest);

    document.getElementById("y").textContent = new Date().getFullYear();
    setOnline(false); // åˆå§‹çŠ¶æ€ï¼šç¦»çº¿
  </script>
</body>
</html>
